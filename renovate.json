{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended"
  ],  
  "timezone": "America/Denver",
  "ignoreTests": true,
  "customManagers": [
    {
      "customType": "regex",
      "fileMatch": ["\\appset-base.yaml$"],
      "matchStrings": [
        "appName: (?<depName>.*?)\\n\\s+# renovate: datasource=(?<datasource>.*?), helmRegistryUrl=(?<registryUrl>.*?)\\n\\s+version:\\s*(?<currentValue>.*)"
      ],
      "datasourceTemplate": "{{#if datasource}}{{{datasource}}}{{else}}helm{{/if}}",
      "registryUrlTemplate": "{{#if registryUrl}}{{{registryUrl}}}{{/if}}",
      "depNameTemplate": "{{depName}}"
    }
  ],
  "packageRules": [
    {
      "description": "Custom Helm charts",
      "matchDatasources": ["helm"],
      "registryUrls": ["https://ownyourio.github.io/SpencersLab/"],
      "matchUpdateTypes": ["minor", "patch"]
    },
    {
      "description": "Internet facing services.",
      "matchUpdateTypes": ["minor", "patch"],
      "automergeSchedule": "[after 1:00am, before 6:00am]",
      "matchPackageNames": ["traefik", "keycloakopenid", "keycloakx", "ghcr.io/linuxserver/openssh-server", "crowdsec"],
      "lockFileMaintenance": { "enabled": true },
      "automerge": true

    },
    {
      "description": "Non-critical services",
      "matchUpdateTypes": ["minor", "patch"],
      "automergeSchedule": "[after 1:00am every tue, before 7:00am every tue]",
      "matchPackageNames": [
        "org.keycloak:keycloak-parent", 
        "jellyseerr", 
        "lidarr", 
        "radarr", 
        "readarr", 
        "sonarr", 
        "ghcr.io/advplyr/audiobookshelf", 
        "ghcr.io/kieraneglin/pinchflat",
        "ghcr.io/onedr0p/qbittorrent",
        "ghcr.io/music-assistant/server",
        "alpine"
      ],
      "lockFileMaintenance": { "enabled": true },
      "automerge": true
    }
  ]
}
