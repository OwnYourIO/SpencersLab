bitwardenIds:
  open-webui-sso-secret: OVERRIDE_VIA_CUSTOM_VALUES
  open-webui-secret: OVERRIDE_VIA_CUSTOM_VALUES
  open-webui-pg: OVERRIDE_VIA_CUSTOM_VALUES
  coder-sso-secret: OVERRIDE_VIA_CUSTOM_VALUES
  coder-pg: OVERRIDE_VIA_CUSTOM_VALUES

seaweedfs-csi-driver:
  seaweedfsFiler: OVERRIDE_VIA_CUSTOM_VALUES

domain: OVERRIDE_VIA_APPSET
clusterName: OVERRIDE_VIA_APPSET

ingress:
  subdomains:
    ollama:
      serviceName: brains
      service: gpu-ollama
      port: 11434

    open-webui:
      serviceName: ai
      service: open-webui
      port: 80

    coder:
      serviceName: code
      service: coder
      port: 8080

    cluster:
      clusterBase: true
      service: base-argocd-server
      port: 80
    traefik:
      clusterBase: true
      namespace: kube-system
      service: traefik
      port: 8080

ollama:
  gpu:
    # -- Enable GPU integration
    enabled: true
    
    # -- GPU type: 'nvidia' or 'amd'
    type: 'amd'
    
    # -- Specify the number of GPU to 1
    number: 1

  resources:
    limits:
      amd.com/gpu: 1 # requesting a GPU
  image:
    repository: ollama/ollama
    tag: 0.11.4-rocm

  extraEnv:
    - name: OLLAMA_NUM_GPU
      value: "10"
    - name: OLLAMA_LOW_VRAM
      value: "true"  

  persistentVolume:
    enabled: true

open-webui:
  annotations:
    reloader.stakater.com/auto: "true"
  #replicaCount: 1
  resources:
    requests:
      cpu: 15m
      memory: 700Mi
    limits:
      cpu: 200m
      memory: 1Gi
  copyAppData:
    resources: {}
  ollama:
    enabled: false
  ollamaUrls: 
    - "http://gpu-ollama.default.svc.cluster.local:11434"
  pipelines:
    enabled: true
    persistence:
      existingClaim: open-webui-pipelines
  tika:
    enabled: true
    resources:
      requests:
        cpu: 15m
        memory: 650Mi
      limits:
        cpu: 100m
        memory: 800Mi
  websocket:
    enabled: true

  extraEnvVars:
    - name: ENABLE_LOGIN_FORM
      value: "false"
    - name: OAUTH_PROVIDER_NAME
      value: login.spencerslab.com
    - name: ENABLE_OAUTH_SIGNUP
      value: "true"
  extraEnvFrom: 
    - secretRef:
        name: open-webui-secrets
  persistence:
    enabled: true
    existingClaim: open-webui
  podSecurityContext:
    supplementalGroups: 
      - 140
  containerSecurityContext:
    runAsUser: 1000
    runAsGroup: 150
    runAsNonRoot: true
    privileged: false
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: false
    capabilities: 
      drop: 
        - "ALL"
    seccompProfile: 
      type: RuntimeDefault
coder: 
  coder:
    env:
      - name: CODER_TELEMETRY
        value: "false"
      - name: CODER_DISABLE_PASSWORD_AUTH
        value: 'true'
      - name: CODER_PROMETHEUS_ENABLE
        value: 'true'
    envFrom:
      - secretRef:
          name: coder-secrets
    # This is needed because the Access URL is coming from envFrom
    envUseClusterAccessURL: false

    service:
      type: ClusterIP
